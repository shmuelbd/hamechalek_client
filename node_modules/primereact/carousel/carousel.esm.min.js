import*as e from"react";import t,{PrimeReactContext as r,ariaLabel as n}from"primereact/api";import{usePrevious as a,useResizeListener as o,useMountEffect as l,useUpdateEffect as u}from"primereact/hooks";import{ChevronDownIcon as c}from"primereact/icons/chevrondown";import{ChevronLeftIcon as i}from"primereact/icons/chevronleft";import{ChevronRightIcon as s}from"primereact/icons/chevronright";import{ChevronUpIcon as m}from"primereact/icons/chevronup";import{Ripple as p}from"primereact/ripple";import{classNames as f,mergeProps as v,UniqueComponentId as d,DomHandler as y,ObjectUtils as b,IconUtils as h}from"primereact/utils";import{ComponentBase as g}from"primereact/componentbase";function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function N(e,t){if("object"!==S(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function E(e){var t=N(e,"string");return"symbol"===S(t)?t:String(t)}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(e){if(Array.isArray(e))return I(e)}function w(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function C(e,t){if(e){if("string"==typeof e)return I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(e,t):void 0}}function P(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(e){if(Array.isArray(e))return e}function x(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,l,u=[],c=!0,i=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(u.push(n.value),u.length!==t);c=!0);}catch(e){i=!0,a=e}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(i)throw a}}return u}}function k(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function T(e,t){return j(e)||x(e,t)||C(e,t)||k()}var A=g.extend({defaultProps:{__TYPE:"Carousel",id:null,value:null,page:0,header:null,footer:null,style:null,className:null,itemTemplate:null,circular:!1,showIndicators:!0,showNavigators:!0,autoplayInterval:0,numVisible:1,numScroll:1,prevIcon:null,nextIcon:null,responsiveOptions:null,orientation:"horizontal",verticalViewPortHeight:"300px",contentClassName:null,containerClassName:null,indicatorsContentClassName:null,onPageChange:null,children:void 0}});function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){var n,a,o;n=e,o=r[t],(a=E(a=t))in n?Object.defineProperty(n,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[a]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var M=e.memo((function(t){var r=t.template(t.item),n=f(t.className,"p-carousel-item",{"p-carousel-item-active":t.active,"p-carousel-item-start":t.start,"p-carousel-item-end":t.end}),a=t.ptm(t.className&&"p-carousel-item-cloned"===t.className?"itemCloned":"item"),o=v({className:n},a);return e.createElement("div",o,r)})),D=e.memo(e.forwardRef((function(g,S){var N=e.useContext(r),E=A.getProps(g,N),I=T(e.useState(E.numVisible),2),j=I[0],x=I[1],k=T(e.useState(E.numScroll),2),R=k[0],D=k[1],B=T(e.useState(E.page*E.numScroll*-1),2),H=B[0],L=B[1],X=T(e.useState(E.page),2),_=X[0],Y=X[1],z=A.setMetaData({props:E,state:{numVisible:j,numScroll:R,totalShiftedItems:H,page:_}}).ptm,J=e.useRef(null),F=e.useRef(null),U=e.useRef(0),W=e.useRef(!!E.autoplayInterval),$=e.useRef(""),q=e.useRef(20),G=e.useRef(null),K=e.useRef(null),Q=e.useRef(null),Z=e.useRef(!1),ee=e.useRef(null),te=a(R),re=a(j),ne=a(E.value),ae=a(E.page),oe="vertical"===E.orientation,le=E.circular||!!E.autoplayInterval,ue=le&&E.value&&E.value.length>=j,ce=E.value?Math.max(Math.ceil((E.value.length-j)/R)+1,0):0,ie=ce&&E.autoplayInterval&&W.current,se=E.onPageChange&&!ie,me=se?E.page:_,pe=T(o({listener:function(){ve()},when:E.responsiveOptions}),1)[0],fe=function(e,t){var r=H;null!=t?(r=R*t*-1,ue&&(r-=j),Z.current=!1):(r+=R*e,Z.current&&(r+=U.current-R*e,Z.current=!1),t=Math.abs(Math.floor((ue?r+j:r)/R)));ue&&_===ce-1&&-1===e?(r=-1*(E.value.length+j),t=0):ue&&0===_&&1===e?(r=0,t=ce-1):t===ce-1&&U.current>0&&(r+=-1*U.current-R*e,Z.current=!0),F.current&&(y.removeClass(F.current,"p-items-hidden"),Ce(r),F.current.style.transition="transform 500ms ease 0s"),Pe(t),L(r)},ve=function(){if(F.current&&ee.current){for(var e=window.innerWidth,t={numVisible:E.numVisible,numScroll:E.numScroll},r=0;r<ee.current.length;r++){var n=ee.current[r];parseInt(n.breakpoint,10)>=e&&(t=n)}if(R!==t.numScroll){var a=Math.floor(me*R/t.numScroll),o=t.numScroll*a*-1;ue&&(o-=t.numVisible),L(o),D(t.numScroll),Pe(a)}j!==t.numVisible&&x(t.numVisible)}},de=function(e,t){(le||0!==me)&&fe(1,t),W.current=!1,e.cancelable&&e.preventDefault()},ye=function(e,t){(le||me<ce-1)&&fe(-1,t),W.current=!1,e.cancelable&&e.preventDefault()},be=function(e,t){t>me?ye(e,t):t<me&&de(e,t)},he=function(e){F.current&&"transform"===e.propertyName&&(y.addClass(F.current,"p-items-hidden"),F.current.style.transition="",0!==_&&_!==ce-1||!ue||Ce(H))},ge=function(e){var t=e.changedTouches[0];G.current={x:t.pageX,y:t.pageY}},Se=function(e){e.cancelable&&e.preventDefault()},Ne=function(e){var t=e.changedTouches[0];Ee(e,oe?t.pageY-G.current.y:t.pageX-G.current.x)},Ee=function(e,t){Math.abs(t)>q.current&&(t<0?ye(e):de(e))},Ie=function(){E.autoplayInterval>0&&(K.current=setInterval((function(){fe(-1,_===ce-1?0:_+1)}),E.autoplayInterval))},Oe=function(){K.current&&clearInterval(K.current)},we=function(){Q.current||(Q.current=y.createInlineStyle(N&&N.nonce||t.nonce));var e,r="\n            .p-carousel[".concat($.current,"] .p-carousel-item {\n                flex: 1 0 ").concat(100/j,"%\n            }\n        ");if(E.responsiveOptions){ee.current=O(e=E.responsiveOptions)||w(e)||C(e)||P(),ee.current.sort((function(e,r){return b.sort(e.breakpoint,r.breakpoint,-1,N&&N.locale||t.locale,N&&N.nullSortOrder||t.nullSortOrder)}));for(var n=0;n<ee.current.length;n++){var a=ee.current[n];r+="\n                    @media screen and (max-width: ".concat(a.breakpoint,") {\n                        .p-carousel[").concat($.current,"] .p-carousel-item {\n                            flex: 1 0 ").concat(100/a.numVisible,"%\n                        }\n                    }\n                ")}}Q.current.innerHTML=r},Ce=function(e){F.current&&(F.current.style.transform=oe?"translate3d(0, ".concat(e*(100/j),"%, 0)"):"translate3d(".concat(e*(100/j),"%, 0, 0)"))},Pe=function(e){!se&&Y(e),E.onPageChange&&E.onPageChange({page:e})};e.useImperativeHandle(S,(function(){return{props:E,startAutoplay:Ie,stopAutoplay:Oe,getElement:function(){return J.current}}})),l((function(){J.current&&($.current=d(),J.current.setAttribute($.current,"")),ve(),Ce(H),pe()})),u((function(){var e=!1,t=H;if(we(),E.autoplayInterval&&Oe(),te!==R||re!==j||E.value&&ne&&ne.length!==E.value.length){U.current=(E.value.length-j)%R;var r=me;0!==ce&&r>=ce&&(Pe(r=ce-1),e=!0),t=r*R*-1,ue&&(t-=j),r===ce-1&&U.current>0?(t+=-1*U.current+R,Z.current=!0):Z.current=!1,t!==H&&(L(t),e=!0),Ce(t)}return ue&&(0===_?t=-1*j:0===t&&(t=-1*E.value.length,U.current>0&&(Z.current=!0)),t!==H&&(L(t),e=!0)),ae!==E.page&&(E.page>ae&&E.page<=ce-1?fe(-1,E.page):E.page<ae&&fe(1,E.page)),!e&&ie&&Ie(),function(){E.autoplayInterval&&Oe(),Q.current=y.removeInlineStyle(Q.current)}}));var je=function(){if(E.value&&E.value.length){var t=null,r=null;if(ue){var n=null;t=(n=E.value.slice(-1*j)).map((function(t,r){return e.createElement(M,{key:r+"_scloned",className:"p-carousel-item-cloned",template:E.itemTemplate,item:t,active:-1*H===E.value.length+j,start:0===r,end:r===n.length-1,ptm:z})})),r=(n=E.value.slice(0,j)).map((function(t,r){return e.createElement(M,{key:r+"_fcloned",className:"p-carousel-item-cloned",template:E.itemTemplate,item:t,active:0===H,start:0===r,end:r===n.length-1,ptm:z})}))}var a=E.value.map((function(t,r){var n=ue?-1*(H+j):-1*H,a=n+j-1;return e.createElement(M,{key:r,template:E.itemTemplate,item:t,active:n<=r&&a>=r,start:n===r,end:a===r,ptm:z})}));return e.createElement(e.Fragment,null,t,a,r)}},xe=function(){if(E.showNavigators){var t=(!le||E.value&&E.value.length<j)&&0===me,r=f("p-carousel-prev p-link",{"p-disabled":t}),a=v({className:"p-carousel-prev-icon"},z("previousButtonIcon")),o=h.getJSXIcon(oe?E.prevIcon||e.createElement(m,a):E.prevIcon||e.createElement(i,a),V({},a),{props:E}),l=v({type:"button",className:r,onClick:function(e){return de(e)},disabled:t,"aria-label":n("previousPageLabel")},z("previousButton"));return e.createElement("button",l,o,e.createElement(p,null))}return null},ke=function(){if(E.showNavigators){var t=(!le||E.value&&E.value.length<j)&&(me===ce-1||0===ce),r=f("p-carousel-next p-link",{"p-disabled":t}),a=v({className:"p-carousel-next-icon"},z("nextButtonIcon")),o=h.getJSXIcon(oe?E.nextIcon||e.createElement(c,a):E.nextIcon||e.createElement(s,a),V({},a),{props:E}),l=v({type:"button",className:r,onClick:function(e){return ye(e)},disabled:t,"aria-label":n("nextPageLabel")},z("nextButton"));return e.createElement("button",l,o,e.createElement(p,null))}return null},Te=function(t){var r="carousel-indicator-"+t,a=f("p-carousel-indicator",{"p-highlight":me===t}),o=v({key:r,className:a},z("indicator")),l=v({type:"button",className:"p-link",onClick:function(e){return be(e,t)},"aria-label":"".concat(n("pageLabel")," ").concat(t+1)},z("indicatorButton"));return e.createElement("li",o,e.createElement("button",l,e.createElement(p,null)))},Ae=f("p-carousel p-component",{"p-carousel-vertical":oe,"p-carousel-horizontal":!oe},E.className),Re=f("p-carousel-content",E.contentClassName),Ve=function(){var t=je(),r=oe?E.verticalViewPortHeight:"auto",n=xe(),a=ke(),o=f("p-carousel-container",E.containerClassName),l=v({className:"p-carousel-items-content",style:{height:r},onTouchStart:function(e){return ge(e)},onTouchMove:function(e){return Se(e)},onTouchEnd:function(e){return Ne(e)}},z("itemsContent")),u=v({className:o},z("container")),c=v({ref:F,className:"p-carousel-items-container",onTransitionEnd:he},z("itemsContainer"));return e.createElement("div",u,n,e.createElement("div",l,e.createElement("div",c,t)),a)}(),Me=function(){if(E.showIndicators){for(var t=f("p-carousel-indicators p-reset",E.indicatorsContentClassName),r=[],n=0;n<ce;n++)r.push(Te(n));var a=v({className:t},z("indicators"));return e.createElement("ul",a,r)}return null}(),De=function(){if(E.header){var t=v({className:"p-carousel-header"},z("header"));return e.createElement("div",t,E.header)}return null}(),Be=function(){if(E.footer){var t=v({className:"p-carousel-footer"},z("footer"));return e.createElement("div",t,E.footer)}return null}(),He=v({id:E.id,ref:J,className:Ae,style:E.style},A.getOtherProps(E),z("root")),Le=v({className:Re},z("content"));return e.createElement("div",He,De,e.createElement("div",Le,Ve,Me),Be)})));M.displayName="CarouselItem",D.displayName="Carousel";export{D as Carousel};
